---
import Layout from '../../layouts/Layout.astro';
import FilterModal from '../../components/transactions/utils/FilterModal.jsx';
import StockOutTable from '../../components/transactions/StockOutTable.jsx';

// Get current page from URL parameters
const currentPage = parseInt(Astro.url.searchParams.get('page') || '1');
const itemsPerPage = 10;
---

<Layout>
	<div class="flex flex-col gap-1 w-full bg-primary p-4 mt-4 rounded-lg">
		<div class="w-full flex justify-between">
			<h1 class="text-xl font-bold">Stock Out Transactions</h1>
			<div class="flex gap-2 items-center">
								<!-- Filter Modal Button -->
				<button
					onclick="document.dispatchEvent(new CustomEvent('open-filter-modal', { detail: { type: 'stock-out' } }))"
					class="p-2 text-textColor-primary hover:bg-btn-hover hover:text-white rounded cursor-pointer"
					title="Filter">
					<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
						<path stroke-linecap="round" stroke-linejoin="round" d="M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z" />
					</svg>
				</button>
				<a href="/transaction/dashboard/" class="p-2 text-textColor-primary hover:bg-btn-hover hover:text-white rounded">
					<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
						<path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
					</svg>
				</a>
			</div>
		</div>

		<div class="p-2 flex flex-col gap-4">
			<StockOutTable showPagination={true} currentPage={currentPage} itemsPerPage={itemsPerPage} client:load />
		</div>
	</div>
	<FilterModal tableType="stock-out" client:load />
</Layout>

<script>
	// No-op script to enable client-side rendering
</script>
